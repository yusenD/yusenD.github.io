---
layout: post
title: Git使用总结（一）
feature-img: "assets/img/background/pexels-photo7.jpeg"
tags: [Git]
---

>  If you listen to your fears, you will die never knowing what a great person you might have been.<br>
>                          
> <p align="right">——Robert Schuller</p>

<br>

对着张哥写的git教程，重新温习Github使用，最近一直用svn，原来学过的git现在只剩下push和pull一些简单命令了。

## 本地基本命令介绍

### git init

初始化仓库命令

### git status

查看git仓库的状态

### git add

提交到git仓库，在没有commit之前，可以使用`git rm --cached`移除这个缓存。

### git commit 

提交信息

### git log

可以看到commit记录

### git branch

可以查看分支情况

分支是十分重要的。如果是多个人进行开发，可以分别在自己的分支上写，最后再合并。

执行init之后，默认在分支master，如果想新建一个分支用`git branch a`

### git checkout

上面新建了一个a分支，如果想要切换到这个分支上面，用命令`git checkout a`。

还可以切换tag或者某次commit（需要commit_id）

还可以撤销，比如在写分支的时候，需求变化了，而且是比较大的变化，之前写的代码完全无法使用，没有add，这时候可以还原。不过只能撤销没有add进暂存区的文件。

### git checkout -b a

这个是上面两个命令的结合，创建a分支并且切换到这个分支上面

### git merge

当在a分支功能完成了，测试也都行，现在需要上线了，就需要把代码合并到master上，然后发布。这时候需要使用`git merge`这个命令。

先切换到master分支，然后执行`git merge a`，意思就是把a分支的代码合并起来。

### git branch -d

可以删除一个分支，比如删除a分支，`git branch -d a`

### git branch -D

a分支没有合并的话，执行-d是没办法删除的，如果要强制删除，用这个命令

### git tag

在开发的时候很可能有版本号，比如v1.0和v2.0等等，用这个命令可以很简单的给代码打上标签，比如`git tag v1.0`。

假如1.1版本除了问题，想要看一下1.0版本是不是也有问题，可以直接切换到这个版本`git checkout v1.0`

### stash

当你正在分支做一个功能，突然有一个BUG要改，但是你当前的代码只写了一半，可以commit但是这就是一个垃圾commit，原则上我们要求每次commit都要有实际的意义，所以我们可以先保存起来，切换到别的分支，修复完BUG之后再切回来。

这时候就是用stash命令，把当前分支没有commit的代码全部暂存起来，这时候再git status你会发现是干净的，没有改动，其实是暂存起来了。

执行`git stash list`就会发现已经有了一条记录。现在你可以切换到其他分支了。还原只需要`git statsh apply`就可以了，然后删除之前的记录`git stash drop`。或者直接用`git stash pop`。

还有一个，`git stash clean`直接清空所有记录，drop只是一条，后面可以有stash_id来删除指定的记录，默认是最近的一条记录，而clean是直接清空了。

## 与Github连接

### 配置SSH

想要不输入密码直接push和pull，需要配置SSH

Linux和MAC都是自带ssh的，在命令行直接输入`ssh-keygen -t rsa`，指定rsa算法生成密钥，然后直接回车就好了，不用输入密码，然后会生成两个文件：
* id_rsa 这个是密钥
* id_rsa.pub 这个是公钥

然后把公钥的内容添加到github就可以了

### 用户名/邮箱

通过`git config --global xx`来配置，如：
* `git config --global user.name`
* `git config --global user.email`

### alias

这个类似于全局变量的概念，可以用自己设定的xx来替换复杂的xxxx。

`git config --global alias.xx xxxx`

比如`git push origin master`向远程仓库origin提交到master命令有点长，可以简化：`git config --global alias.psm`，这样直接用`git psm`就可以了。

再有一个命令，可以让git log更好看：

`git log --graph --pretty=format:'%Cred%h - %Cgreen[%an]%Creset -%C(yellow)%d%Creset %s %C(yellow)<%cr>%Creset' --abbrev-commit --date=relative`

这个就可以设置成lg：

`git config --global alias.lg "log --graph --pretty=format:'%Cred%h - %Cgreen[%an]%Creset -%C(yellow)%d%Creset %s %C(yellow)<%cr>%Creset' --abbrev-commit --date=relative"`

还有其他的几种样式：

`git config --global alias.lg "log --color --graph --pretty=format:'%Cred%h%Creset -%C(yellow)%d%Creset %s %Cgreen(%cr) %C(bold blue)<%an>%Creset' --abbrev-commit --"`

`git config --global alias.his "log --graph --decorate --oneline --pretty=format:'%Creset %s %C(magenta)in %Cred%h %C(magenta)commited by %Cgreen%cn %C(magenta)on %C(yellow) %cd %C(magenta)from %Creset %C(yellow)%d' --abbrev-commit --date=format:'%Y-%m-%d %H:%M:%S'"`

`git config --global alias.hist "log --graph --decorate --oneline --pretty=format:'%Cred%h - %C(bold white) %s %Creset %C(yellow)%d  %C(cyan) <%cd> %Creset %Cgreen(%cn)' --abbrev-commit --date=format:'%Y-%m-%d %H:%M:%S'"`

### diff

diff命令很常用，是用来查看文件修改记录的。如`git diff a.txt`就可已查看工作区和暂存区文件的差异。（暂存区就是你add进去的内容，工作区就是你的本地文件。）

```
git diff <$id1><$id2> 用于比较两次提交之间的差异
git diff <branch1><branch2> 在两个分区之间进行比较
git diff --staged 用于比较缓存区和版本库的差异
```

### merge和rebase

合并分支不仅有merge，还有rebase。

```
git checkout master
git merge a

git checkout master
git rebase a

上面是一样的

```

这两个是不同的策略进行合并，假设一个场景，你现在需要把两个书架的书籍整理到一起：
* merge是直接腾出一块地方，把一个书架的数全部放到另一个书架里面，你可以知道那些书是来自另一个书架的。
* rebase是先对两个书架的书进行比较，按照购买书籍的时间来给他重新排序，然后重新放置，这样做的好处就是合并之后的书架看起来非常有逻辑，但是不太好看出哪些书是来自哪个书架的。

### 解决冲突

这个确实比较头疼的。

在开发中要减少冲突的出现，但是总归是无法避免的。

如果两个人同时改了一个地方，那么git提示冲突，会有`<<<<<<HEAD`、`=======`和`>>>>>>>>`标志，把代码分成了两块，前面的是当前所在分支的代码，后面的是另一个分支所在的代码。然后可以进行取舍，修改，最后把这些标志也删除，再进行commit就可以了。

## Git分支

来来来，Git Flow 了解一下










