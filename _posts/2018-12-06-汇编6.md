---
layout: post
title: 汇编（六）——程序设计
feature-img: "assets/img/background/pexels-photo5.jpeg"
tags: [汇编]
---

> Everyone you will ever meet knows something you don't. <br>

<br>

### 1.一些符号

#### 取值运算符

> OFFSET => 取得后面变量或标号的**偏移地址**
> SEG => 取得后面变量或者是标号的**段地址**

例：
{% highlight java%}

MOV AX, SEG DATA
MOV DS, AX ;这两条命令是取变量的段地址送给DS
MOV BX, OFFSET DATA ;取变量的偏移地址送给BX，可以等价于LEA BX, DATA

{% endhighlight %}

----

#### 属性运算符

**PTR**用于指定后面存储器操作数的类型

例：

> MOV BYTE PTR[BX], 12H

----

### 2.伪指令

* 由汇编程序执行的指令系统，不会真的执行，是告诉计算机理解汇编源程序

#### ①数据定义伪指令

用于定义数据区中变量的类型及其所占内存空间的大小

| DB | 定义的变量为字节型，占一个字节单元 | DW | 定义的变量为字类型，占一个字单元，即两个字节单元|
| DD | 定义的变量为双字型 | DQ | 四字型 |

例子🌰：
{% highlight java%}

DATA1 DB 11H, 22H, 33H, 44H
DATA2 DW 11H, 22H, 3344H
DATA3 DD 11H*2(实际上就是22H，00000022H), 22H, 33445566H

内存分布自己想象
{% endhighlight %}

需要注意的：定义字符串必须要用DB，如`DATA1 DB 'ABCD'`

#### ②重复操作符

可以为一个数据区的各个单元设置相同的初值

> [变量名] 伪指令助记符 n DUP (初值[,...])
> M1 DB 10 DUP(0) ;10个单元，每个单元都是0

“？”表示随机值，用于预留空间

如：
> M1 DB 'HOW ARE YOU' ;注意空格也占一个字符
> M2 DW 3 DUP(11H), 3344H ;前三个是0011H，后面一个3344H
>    DB 4 DUP (?) ;定义了一个区间，4个重复
> M3 DB 3 DUP (22H, 11H, ?) ;括号的内容重复三次

#### ③符号定义伪指令

将表达式的值赋给一个名字，当源程序多次使用一个表达式时，可以使用EQU，用一个符号代替

> 符号名 EQU 表达式
> CONSTANT EQU 100

不可以重复定义，EQU的表达式不占用内存空间

#### ④段定义伪指令

> 段名  SEGMENT [定位类型][组合类型]['类型'] 
> ....
> 段名  ENDS
> 
> 段名：逻辑段的段基地址
> 定位类型：说明逻辑段的起点
> 组合类型：装入内存时逻辑段的组合方式

例子🌰：

{% highlight java%}

DATA SEGMENT
    M1 DB 11H, 22H
    M2 DB 'HELLO'
DATA ENDS

{% endhighlight %}

#### ⑤设定段寄存器伪指令

> ASSUME 段寄存器:段名[，段寄存器名:段名，...]

串操作必须要在附加段，有堆栈操作要有堆栈段

#### ⑥结束伪指令

源程序结束

> END [标号]

----

#### 一个完整源程序例子🌰

{% highlight java%}

DSEG SEGMENT
    DATA1 DB 1,2,3 DP(?)
    DATA2 DW 1234H
DSEG ENDS
ESEG SEGMENT
    DB 20 DUP (?)
ESEG ENDS
SSEG SEGMENT STACK 'STACK'
    DB 200 DUP (?)
SSEG ENDS

CSEG SEGMENT
    ASSUME CS: CSEG, DS: DSEG, ES:ESEG, SS: SSEG
START: MOV AX, DSEG
    MOV DS,AX
    MOV AX, ESEG
    MOV ES, AX
    MOV AX, SSEG
    MOV SS, AX  ;上面的代码是段寄存器初始化，将段地址送相应的段寄存器
    .... ;源代码程序

CSEG ENDS
END START
{% endhighlight %}










 